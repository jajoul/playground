<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>tuffus - AI Chat</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">tuffus</div>
            <ul>
                <li><a href="#">PRODUCT</a></li>
                <li><a href="#">COMPANY</a></li>
                <li><a href="#">LATEST</a></li>
                <li><a href="#">PRICING</a></li>
                <li><a href="#">CONTACT</a></li>
            </ul>
            <a href="#" class="signup-btn">SIGN UP</a>
        </nav>
    </header>

    <main>
        <div class="chat-container">
            <h1>AI Chat</h1>

            {% if error %}
                <p class="error">{{ error }}</p>
            {% endif %}

            <form method="post" class="chat-form">
                {% csrf_token %}
                <input type="text" name="subject" placeholder="Enter a subject" required value="{{ current_chat.subject|default_if_none:subject|default_if_none:'' }}">
                <input type="text" name="first_bot_name" placeholder="Enter first bot name" value="{{ current_chat.first_bot_name|default_if_none:first_bot_name|default_if_none:'tuffus' }}" required>
                <input type="text" name="second_bot_name" placeholder="Enter second bot name" value="{{ current_chat.second_bot_name|default_if_none:second_bot_name|default_if_none:'muffin' }}" required>
                <button type="submit">Generate PDF</button>
            </form>

            <div class="response">
                <h2>Conversation</h2>
                {% if current_chat %}
                    <a href="{% url 'download_pdf' current_chat.id %}" class="download-btn">Download PDF</a>
                {% endif %}
                <div id="conversation-content">
                    {% if conversation %}
                        {% for message in conversation %}
                            <p><strong>{{ message.role }}:</strong> {{ message.content|safe }}</p>
                        {% endfor %}
                    {% else %}
                        <p>No conversation generated yet. Submit the form to create one!</p>
                    {% endif %}
                </div>
            </div>

            <h2>Chat History</h2>
            <ul class="chat-history">
                {% for chat in chats %}
                    <li><a href="{% url 'ai_chat_detail' chat.id %}">{{ chat.subject }} ({{ chat.first_bot_name }} vs {{ chat.second_bot_name }}) - <i>{{ chat.created_at|date:"Y-m-d H:i" }}</i></a></li>
                {% empty %}
                    <li>No chat history yet.</li>
                {% endfor %}
            </ul>
        </div>
    </main>

</body>
</html>